<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>PIE Section Player Demo</title>
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
			max-width: 1200px;
			margin: 0 auto;
			padding: 2rem;
			background: #f5f5f5;
		}

		h1 {
			color: #333;
			margin-bottom: 2rem;
		}

		.controls {
			margin-bottom: 2rem;
			padding: 1rem;
			background: white;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		}

		.controls h2 {
			margin-top: 0;
			font-size: 1.2rem;
			color: #555;
		}

		.button-group {
			display: flex;
			gap: 1rem;
			margin-bottom: 1rem;
		}

		button {
			padding: 0.5rem 1rem;
			background: #007bff;
			color: white;
			border: none;
			border-radius: 4px;
			cursor: pointer;
			font-size: 0.9rem;
		}

		button:hover {
			background: #0056b3;
		}

		button.secondary {
			background: #6c757d;
		}

		button.secondary:hover {
			background: #545b62;
		}

		.player-container {
			background: white;
			border-radius: 8px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			padding: 1rem;
		}

		.event-log {
			margin-top: 2rem;
			padding: 1rem;
			background: #f9f9f9;
			border: 1px solid #ddd;
			border-radius: 4px;
			max-height: 200px;
			overflow-y: auto;
		}

		.event-log h3 {
			margin-top: 0;
			font-size: 1rem;
			color: #555;
		}

		.event-log pre {
			margin: 0.5rem 0;
			padding: 0.5rem;
			background: white;
			border: 1px solid #e0e0e0;
			border-radius: 2px;
			font-size: 0.85rem;
			overflow-x: auto;
		}
	</style>
</head>
<body>
	<h1>ðŸ¥§ PIE Section Player Demo</h1>

	<div class="controls">
		<h2>Controls</h2>
		<div class="button-group">
			<button onclick="loadPageMode()">Load Page Mode (Paired Passages)</button>
			<button onclick="loadItemMode()">Load Item Mode (One at a Time)</button>
			<button class="secondary" onclick="clearLog()">Clear Event Log</button>
		</div>
	</div>

	<div class="player-container">
		<pie-section-player id="player"></pie-section-player>
	</div>

	<div class="event-log">
		<h3>Event Log</h3>
		<div id="log"></div>
	</div>

	<script type="module">
		// Import the web component
		import './dist/pie-section-player.js';

		const player = document.getElementById('player');
		const log = document.getElementById('log');

		// Event listeners
		player.addEventListener('section-loaded', (e) => {
			addLog('section-loaded', e.detail);
		});

		player.addEventListener('item-changed', (e) => {
			addLog('item-changed', e.detail);
		});

		player.addEventListener('session-changed', (e) => {
			addLog('session-changed', e.detail);
		});

		player.addEventListener('player-error', (e) => {
			addLog('player-error', e.detail);
		});

		function addLog(eventName, detail) {
			const entry = document.createElement('pre');
			entry.textContent = `[${new Date().toLocaleTimeString()}] ${eventName}: ${JSON.stringify(detail, null, 2)}`;
			log.insertBefore(entry, log.firstChild);
		}

		window.clearLog = () => {
			log.innerHTML = '';
		};

		// Sample data
		window.loadPageMode = () => {
			player.section = {
				identifier: 'paired-passages-page',
				title: 'Urban Gardens: Different Perspectives',
				keepTogether: true,

				rubricBlocks: [
					{
						id: 'instructions',
						view: 'candidate',
						use: 'instructions',
						passage: {
							id: 'inst-001',
							name: 'Directions',
							baseId: 'inst-001',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="inst" class="instructions"><h3>Directions</h3><p>Read both passages below and answer the questions that follow.</p></div>',
								elements: {},
								models: []
							}
						}
					},
					{
						id: 'passage-1',
						view: 'candidate',
						use: 'passage',
						passage: {
							id: 'passage-benefits',
							name: 'The Benefits of Urban Gardening',
							baseId: 'passage-benefits',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="p1" class="passage"><h2>Passage 1: The Benefits of Urban Gardening</h2><p>When empty lots transform into community gardens, neighborhoods experience remarkable changes. Fresh vegetables grow where trash once accumulated, and community members gather to tend plots together.</p><p>Urban gardens provide multiple benefits: they improve air quality, reduce urban heat islands, and create habitats for pollinators. Most importantly, they bring communities together around a shared purpose.</p></div>',
								elements: {},
								models: []
							}
						}
					},
					{
						id: 'passage-2',
						view: 'candidate',
						use: 'passage',
						passage: {
							id: 'passage-challenges',
							name: 'Urban Gardens: Challenges',
							baseId: 'passage-challenges',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="p2" class="passage"><h2>Passage 2: Urban Gardens - Challenges and Limitations</h2><p>While urban gardens have gained popularity, they face significant obstacles. Soil contamination from previous industrial use poses health risks. Limited space restricts what can be grown.</p><p>Water access remains problematic in many areas, and maintaining gardens requires sustained volunteer commitment that often wanes over time.</p></div>',
								elements: {},
								models: []
							}
						}
					}
				],

				assessmentItemRefs: [
					{
						identifier: 'q1',
						required: true,
						item: {
							id: 'item-001',
							name: 'Question 1',
							baseId: 'item-001',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="q1"><p><strong>Question 1:</strong> What is the main idea of Passage 1?</p><p><input type="radio" name="q1" value="a"> A) Urban gardens help reduce flooding<br><input type="radio" name="q1" value="b"> B) Urban gardens improve neighborhoods in multiple ways<br><input type="radio" name="q1" value="c"> C) Gardens are expensive</p></div>',
								elements: {},
								models: []
							}
						}
					},
					{
						identifier: 'q2',
						required: true,
						item: {
							id: 'item-002',
							name: 'Question 2',
							baseId: 'item-002',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="q2"><p><strong>Question 2:</strong> What challenge is mentioned in Passage 2?</p><p><input type="radio" name="q2" value="a"> A) Too much rain<br><input type="radio" name="q2" value="b"> B) Soil contamination<br><input type="radio" name="q2" value="c"> C) Too much sunlight</p></div>',
								elements: {},
								models: []
							}
						}
					}
				]
			};

			player.mode = 'gather';
			player.view = 'candidate';
		};

		window.loadItemMode = () => {
			player.section = {
				identifier: 'item-by-item-section',
				title: 'Reading Comprehension',
				keepTogether: false,

				rubricBlocks: [
					{
						id: 'passage',
						view: 'candidate',
						use: 'passage',
						passage: {
							id: 'passage-solar',
							name: 'The Solar System',
							baseId: 'passage-solar',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="p" class="passage"><h2>The Solar System</h2><p>Our solar system consists of the Sun and everything that orbits around it, including eight planets, their moons, asteroids, comets, and other celestial objects.</p><p>The Sun, a massive ball of hot gas, contains 99.8% of the solar system\'s mass and provides the energy that sustains life on Earth.</p></div>',
								elements: {},
								models: []
							}
						}
					}
				],

				assessmentItemRefs: [
					{
						identifier: 'q1',
						required: true,
						item: {
							id: 'item-001',
							name: 'Question 1',
							baseId: 'item-001',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="q1"><p><strong>Question 1:</strong> What is at the center of our solar system?</p><p><input type="radio" name="q1" value="sun"> A) The Sun<br><input type="radio" name="q1" value="earth"> B) The Earth<br><input type="radio" name="q1" value="moon"> C) The Moon</p></div>',
								elements: {},
								models: []
							}
						}
					},
					{
						identifier: 'q2',
						required: true,
						item: {
							id: 'item-002',
							name: 'Question 2',
							baseId: 'item-002',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="q2"><p><strong>Question 2:</strong> How many planets orbit the Sun?</p><p><input type="radio" name="q2" value="seven"> A) Seven<br><input type="radio" name="q2" value="eight"> B) Eight<br><input type="radio" name="q2" value="nine"> C) Nine</p></div>',
								elements: {},
								models: []
							}
						}
					},
					{
						identifier: 'q3',
						required: true,
						item: {
							id: 'item-003',
							name: 'Question 3',
							baseId: 'item-003',
							version: { major: 1, minor: 0, patch: 0 },
							config: {
								markup: '<div id="q3"><p><strong>Question 3:</strong> What percentage of the solar system\'s mass does the Sun contain?</p><p><input type="radio" name="q3" value="a"> A) 50%<br><input type="radio" name="q3" value="b"> B) 99.8%<br><input type="radio" name="q3" value="c"> C) 75%</p></div>',
								elements: {},
								models: []
							}
						}
					}
				]
			};

			player.mode = 'gather';
			player.view = 'candidate';
		};

		// Load page mode by default
		loadPageMode();
	</script>
</body>
</html>
